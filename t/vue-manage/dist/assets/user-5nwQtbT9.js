import{_ as ce,s as F,q as _,v as _e,ao as xe,G as b,r as n,d as be,o as y,a as d,b as l,w as t,h as i,c as h,e as I,t as ve,as as Ve,L as f,ar as we,ap as ye,aq as ze,H as ke,at as Ne}from"./index-Ck829hgR.js";const Ue={class:"user"},Ce={class:"search-table"},Ae={class:"search"},he={class:"table"},qe={class:"dialog-footer"},Se={style:{width:"100%"}},Be={style:{width:"100%"}},De={style:{width:"100%"}},Pe={style:{width:"100%"}},Te={style:{width:"100%"}},Re={style:{width:"100%"}},Ee={style:{width:"100%"}},Fe={slot:"footer",class:"dialog-footer"},Ie={style:{width:"100%"}},$e={style:{width:"100%"}},Me={style:{width:"100%"}},Ge={style:{width:"100%"}},He={style:{width:"100%"}},Le={style:{width:"100%"}},je={slot:"footer",class:"dialog-footer"},Je={__name:"user",setup(Ke){const p=F({userName:"",tel:"",status:"",userType:1,pageNumber:1,pageSize:10}),$=_([]),M=_(0),z=_(!1),k=_(!1),J=_(""),N=_(!1),q=_(""),S=_(""),w=_(""),G=_([]),K=_([]),s=F({userName:"",loginAccount:"",userType:1,email:"",tel:"",sex:"",avatar:"",password:"",status:"0",remark:""}),O={userName:[{required:!0,message:"请输入用户昵称",trigger:"blur"}],loginAccount:[{required:!0,message:"请输入登录账号",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"}],tel:[{required:!0,message:"请输入联系方式",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"blur"}]},r=F({userName:"",loginAccount:"",userType:1,email:"",tel:"",sex:"",avatar:"",password:"",status:"0",remark:""}),Q={userName:[{required:!0,message:"请输入用户昵称",trigger:"blur"}],loginAccount:[{required:!0,message:"请输入登录账号",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"}],tel:[{required:!0,message:"请输入联系方式",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"blur"}]};_e(()=>{v()});const v=async()=>{try{const a=await xe(p);a.code===1e3?($.value=a.data.records,M.value=a.data.total):b.error({title:"错误",message:a.message})}catch(a){console.error("查询失败:",a)}},W=()=>{p.userName="",p.tel="",p.status="",v()},X=a=>{p.pageSize=a,v()},Y=a=>{p.pageNumber=a,v()},Z=a=>{G.value=a.map(e=>e.id),K.value=a.map(e=>e.id)},ee=a=>{const[e,g,u]=a.split("#");switch(g){case"edit":J.value=e,Ve({id:e}).then(m=>{m.code===1e3?(r.userName=m.data.userName,r.loginAccount=m.data.loginAccount,r.email=m.data.email,r.tel=m.data.tel,r.sex=m.data.sex+"",r.status=m.data.status+"",r.remark=m.data.remark,k.value=!0):b.error({title:"错误",message:m.message})});break;case"pass":q.value=u,S.value=e,N.value=!0;break;case"remove":le(e);break}},le=a=>{ke.confirm("确定删除选中的数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{te(a)}).catch(()=>{})},te=async a=>{try{const e=await Ne({ids:a});e.code===1e3?(f.success("删除成功!"),v()):b.error({title:"错误",message:e.message})}catch(e){console.error("删除失败:",e)}},B=()=>{N.value=!1,q.value="",S.value="",w.value=""},oe=async()=>{if(!w.value.trim()){f.warning("请输入新密码");return}try{const a=await we({id:S.value,newPassword:w.value});a.code===1e3?(b.success({title:"成功",message:"重置成功"}),B()):b.error({title:"错误",message:a.message})}catch(a){console.error("密码重置失败:",a)}},ae=()=>{z.value=!0},D=()=>{z.value=!1,s.userName="",s.loginAccount="",s.email="",s.tel="",s.sex="",s.password="",s.status="0",s.remark=""},se=()=>{if(!s.userName.trim()){f.error("请输入用户昵称");return}if(!s.loginAccount.trim()){f.error("请输入登录账号");return}if(!s.password.trim()){f.error("请输入用户密码");return}if(!s.tel.trim()){f.error("请输入手机号码");return}if(!s.email.trim()){f.error("请输入邮箱");return}if(!s.sex.trim()){f.error("请选择性别");return}ye(s).then(a=>{a.code===1e3?(b.success({title:"成功",message:"新增用户成功"}),D(),v()):b.error({title:"错误",message:a.message})})},P=()=>{k.value=!1},re=()=>{if(!r.userName.trim()){f.error("请输入用户昵称");return}if(!r.loginAccount.trim()){f.error("请输入登录账号");return}if(!r.password.trim()){f.error("请输入用户密码");return}if(!r.tel.trim()){f.error("请输入手机号码");return}if(!r.email.trim()){f.error("请输入邮箱");return}if(!r.sex.trim()){f.error("请选择性别");return}ze(r).then(a=>{a.code===1e3?(b.success({title:"成功",message:"修改用户成功"}),P(),v()):b.error({title:"错误",message:a.message})})};return(a,e)=>{const g=n("el-input"),u=n("el-col"),m=n("el-option"),T=n("el-select"),de=n("Search"),U=n("el-icon"),x=n("el-button"),ne=n("Refresh"),C=n("el-row"),ie=n("Plus"),ue=n("Delete"),V=n("el-table-column"),H=n("el-tag"),R=n("el-dropdown-item"),me=n("el-dropdown-menu"),pe=n("el-dropdown"),ge=n("el-table"),fe=n("el-pagination"),E=n("el-dialog"),c=n("el-form-item"),A=n("el-radio"),L=n("el-radio-group"),j=n("el-form");return y(),be("div",Ue,[d("div",Ce,[d("div",Ae,[l(C,{gutter:10,style:{padding:"10px"}},{default:t(()=>[l(u,{xs:24,sm:12,md:8,lg:8,xl:8},{default:t(()=>[e[20]||(e[20]=d("span",{class:"search-title"},"用户名称:",-1)),l(g,{style:{"margin-top":"10px"},size:"mini",placeholder:"请输入用户名称",modelValue:p.userName,"onUpdate:modelValue":e[0]||(e[0]=o=>p.userName=o)},null,8,["modelValue"])]),_:1}),l(u,{xs:24,sm:12,md:8,lg:8,xl:8},{default:t(()=>[e[21]||(e[21]=d("span",{class:"search-title"},"手机号码:",-1)),l(g,{style:{"margin-top":"10px"},size:"mini",placeholder:"请输入手机号码",modelValue:p.tel,"onUpdate:modelValue":e[1]||(e[1]=o=>p.tel=o)},null,8,["modelValue"])]),_:1}),l(u,{xs:24,sm:12,md:8,lg:8,xl:8},{default:t(()=>[e[22]||(e[22]=d("span",{class:"search-title"},"状态:",-1)),l(T,{clearable:"",style:{"margin-top":"10px"},size:"mini",modelValue:p.status,"onUpdate:modelValue":e[2]||(e[2]=o=>p.status=o),placeholder:"请选择"},{default:t(()=>[l(m,{label:"正常",value:"0"}),l(m,{label:"停用",value:"1"})]),_:1},8,["modelValue"])]),_:1}),l(u,{xs:24,sm:12,md:8,lg:8,xl:8},{default:t(()=>[l(x,{style:{"margin-top":"10px"},size:"mini",type:"primary",onClick:a.searchPage},{default:t(()=>[l(U,null,{default:t(()=>[l(de)]),_:1}),e[23]||(e[23]=i("查询 "))]),_:1},8,["onClick"]),l(x,{style:{"margin-top":"10px"},size:"mini",onClick:W},{default:t(()=>[l(U,null,{default:t(()=>[l(ne)]),_:1}),e[24]||(e[24]=i("重置 "))]),_:1})]),_:1})]),_:1})]),d("div",he,[l(C,{style:{"padding-top":"10px","margin-left":"10px"}},{default:t(()=>[l(x,{type:"primary",size:"mini",plain:"",onClick:ae},{default:t(()=>[l(U,null,{default:t(()=>[l(ie)]),_:1}),e[25]||(e[25]=i("新增"))]),_:1}),l(x,{type:"danger",disabled:G.value.length<=0,size:"mini",plain:"",onClick:a.deleteDataBtn},{default:t(()=>[l(U,null,{default:t(()=>[l(ue)]),_:1}),e[26]||(e[26]=i("删除 "))]),_:1},8,["disabled","onClick"])]),_:1}),l(ge,{data:$.value,onSelectionChange:Z,stripe:"",style:{width:"100%"}},{default:t(()=>[l(V,{type:"selection",width:"55"}),l(V,{prop:"userName",label:"用户名称",width:"150"}),l(V,{prop:"loginAccount",label:"登录账号",width:"150"}),l(V,{prop:"tel",label:"手机号",width:"150"}),l(V,{prop:"status",label:"状态",width:"100"},{default:t(({row:o})=>[o.status===0?(y(),h(H,{key:0},{default:t(()=>e[27]||(e[27]=[i("正常")])),_:1})):o.status===1?(y(),h(H,{key:1,type:"warning"},{default:t(()=>e[28]||(e[28]=[i("停用")])),_:1})):I("",!0)]),_:1}),l(V,{prop:"createTime",label:"创建时间"}),l(V,{label:"操作"},{default:t(({row:o})=>[l(pe,{trigger:"hover",onCommand:ee},{dropdown:t(()=>[l(me,null,{default:t(()=>[l(R,{icon:"el-icon-edit",command:`${o.id}#edit`},{default:t(()=>e[29]||(e[29]=[i(" 修改 ")])),_:2},1032,["command"]),o.loginAccount!=="admin"?(y(),h(R,{key:0,icon:"el-icon-check",command:`${o.id}#pass#${o.userName}`},{default:t(()=>e[30]||(e[30]=[i(" 重置密码 ")])),_:2},1032,["command"])):I("",!0),o.loginAccount!=="admin"?(y(),h(R,{key:1,icon:"el-icon-remove",command:`${o.id}#remove`},{default:t(()=>e[31]||(e[31]=[i(" 删除 ")])),_:2},1032,["command"])):I("",!0)]),_:2},1024)]),default:t(()=>[e[32]||(e[32]=d("span",{class:"el-dropdown-link"},[i(" 操作"),d("i",{class:"el-icon-arrow-down el-icon--right"})],-1))]),_:2},1024)]),_:1})]),_:1},8,["data"]),l(fe,{background:"",layout:"total, prev, pager, next","page-sizes":[20,30,50,100],"page-size":p.pageSize,"current-page":p.pageNumber,onSizeChange:X,onCurrentChange:Y,total:M.value},null,8,["page-size","current-page","total"])])]),l(E,{modelValue:N.value,"onUpdate:modelValue":e[4]||(e[4]=o=>N.value=o),title:"重置密码",width:"30%","before-close":B},{footer:t(()=>[d("span",qe,[l(x,{size:"mini",onClick:B},{default:t(()=>e[33]||(e[33]=[i("取 消")])),_:1}),l(x,{size:"mini",type:"primary",onClick:oe},{default:t(()=>e[34]||(e[34]=[i("确 定")])),_:1})])]),default:t(()=>[d("span",null,"请输入"+ve(q.value)+"的新密码：",1),l(g,{style:{"margin-top":"10px"},"show-password":"",modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=o=>w.value=o),size:"mini",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["modelValue"]),l(E,{title:"新增普通用户",width:"40%","destroy-on-close":!0,modelValue:z.value,"onUpdate:modelValue":e[12]||(e[12]=o=>z.value=o),"before-close":D},{default:t(()=>[l(j,{model:s,rules:O,ref:"addRuleForm"},{default:t(()=>[l(C,{gutter:10},{default:t(()=>[l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",Se,[l(c,{prop:"userName",label:"昵称"},{default:t(()=>[l(g,{modelValue:s.userName,"onUpdate:modelValue":e[5]||(e[5]=o=>s.userName=o),size:"mini",placeholder:"请输入用户昵称",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",Be,[l(c,{prop:"tel",label:"号码"},{default:t(()=>[l(g,{modelValue:s.tel,"onUpdate:modelValue":e[6]||(e[6]=o=>s.tel=o),size:"mini",placeholder:"请输入手机号码",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",De,[l(c,{prop:"email",label:"邮箱"},{default:t(()=>[l(g,{modelValue:s.email,"onUpdate:modelValue":e[7]||(e[7]=o=>s.email=o),size:"mini",placeholder:"请输入邮箱",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",Pe,[l(c,{prop:"loginAccount",label:"账号"},{default:t(()=>[l(g,{modelValue:s.loginAccount,"onUpdate:modelValue":e[8]||(e[8]=o=>s.loginAccount=o),size:"mini",placeholder:"请输入登录账号",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",Te,[l(c,{prop:"password",label:"密码"},{default:t(()=>[l(g,{modelValue:s.password,"onUpdate:modelValue":e[9]||(e[9]=o=>s.password=o),"show-password":"",size:"mini",placeholder:"请输入用户密码",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",Re,[l(c,{prop:"sex",label:"性别"},{default:t(()=>[l(T,{size:"mini",modelValue:s.sex,"onUpdate:modelValue":e[10]||(e[10]=o=>s.sex=o),placeholder:"请选择用户性别"},{default:t(()=>[l(m,{label:"男",value:"0"}),l(m,{label:"女",value:"1"})]),_:1},8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",Ee,[l(c,{prop:"name",label:"状态"},{default:t(()=>[l(L,{style:{"margin-top":"1px",height:"40px",display:"flex","align-items":"center"},modelValue:s.status,"onUpdate:modelValue":e[11]||(e[11]=o=>s.status=o)},{default:t(()=>[l(A,{label:"0"},{default:t(()=>e[35]||(e[35]=[i("正常")])),_:1}),l(A,{label:"1"},{default:t(()=>e[36]||(e[36]=[i("停用")])),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"]),d("div",Fe,[l(x,{size:"mini",type:"primary",onClick:se},{default:t(()=>e[37]||(e[37]=[i("确 定")])),_:1}),l(x,{size:"mini",onClick:D},{default:t(()=>e[38]||(e[38]=[i("取 消")])),_:1})])]),_:1},8,["modelValue"]),l(E,{title:"修改普通用户",width:"40%","destroy-on-close":!0,modelValue:k.value,"onUpdate:modelValue":e[19]||(e[19]=o=>k.value=o),"before-close":P},{default:t(()=>[l(j,{model:r,rules:Q,ref:"updateRuleForm"},{default:t(()=>[l(C,{gutter:10},{default:t(()=>[l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",Ie,[l(c,{prop:"userName",label:"昵称"},{default:t(()=>[l(g,{modelValue:r.userName,"onUpdate:modelValue":e[13]||(e[13]=o=>r.userName=o),size:"mini",placeholder:"请输入用户昵称",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",$e,[l(c,{prop:"tel",label:"号码"},{default:t(()=>[l(g,{modelValue:r.tel,"onUpdate:modelValue":e[14]||(e[14]=o=>r.tel=o),size:"mini",placeholder:"请输入手机号码",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",Me,[l(c,{prop:"email",label:"邮箱"},{default:t(()=>[l(g,{modelValue:r.email,"onUpdate:modelValue":e[15]||(e[15]=o=>r.email=o),size:"mini",placeholder:"请输入邮箱",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",Ge,[l(c,{prop:"loginAccount",label:"账号"},{default:t(()=>[l(g,{modelValue:r.loginAccount,"onUpdate:modelValue":e[16]||(e[16]=o=>r.loginAccount=o),size:"mini",placeholder:"请输入登录账号",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",He,[l(c,{prop:"sex",label:"性别"},{default:t(()=>[l(T,{size:"mini",modelValue:r.sex,"onUpdate:modelValue":e[17]||(e[17]=o=>r.sex=o),placeholder:"请选择用户性别"},{default:t(()=>[l(m,{label:"男",value:"0"}),l(m,{label:"女",value:"1"})]),_:1},8,["modelValue"])]),_:1})])]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[d("div",Le,[l(c,{prop:"name",label:"状态"},{default:t(()=>[l(L,{style:{"margin-top":"1px",height:"40px",display:"flex","align-items":"center"},modelValue:r.status,"onUpdate:modelValue":e[18]||(e[18]=o=>r.status=o)},{default:t(()=>[l(A,{label:"0"},{default:t(()=>e[39]||(e[39]=[i("正常")])),_:1}),l(A,{label:"1"},{default:t(()=>e[40]||(e[40]=[i("停用")])),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"]),d("div",je,[l(x,{size:"mini",type:"primary",onClick:re},{default:t(()=>e[41]||(e[41]=[i("确 定")])),_:1}),l(x,{size:"mini",onClick:P},{default:t(()=>e[42]||(e[42]=[i("取 消")])),_:1})])]),_:1},8,["modelValue"])])}}},Qe=ce(Je,[["__scopeId","data-v-3ad23036"]]);export{Qe as default};
