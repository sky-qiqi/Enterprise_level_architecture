import{_ as Y,q as u,s as w,v as Z,r as n,x as ee,d as te,o as R,a as V,b as t,w as l,h as r,y as C,z as le,A as oe,B as ae,C as ne,D as se,c as re,a4 as de,L as f,H as ie,a5 as ue,a6 as pe,a7 as me,a8 as ce}from"./index-Ck829hgR.js";const fe={class:"_forum"},ge={class:"search-table"},_e={class:"search"},ve={class:"table"},ye={__name:"forum",setup(be){const z=u(!0),v=u([]),k=u(""),g=u(!1),_=u(!1),F=u([]),B=u(0),d=w({title:"",pageNumber:1,pageSize:10}),p=w({title:"",content:""}),U=u(null),i=w({title:"",content:""}),D=u(null),N={title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},m=async()=>{try{const o=await de(d);o.code===1e3?(F.value=o.data.records,B.value=o.data.total):f.error(o.message)}catch(o){console.error(o)}finally{z.value=!1}},T=()=>{d.pageNumber=1,m()},E=()=>{d.title="",m()},M=o=>{d.pageSize=o,m()},j=o=>{d.pageNumber=o,m()},A=o=>{v.value=o.map(e=>e.id)},P=()=>{p.title="",p.content="",g.value=!0},H=async o=>{k.value=o;try{const e=await ue({id:o});e.code===1e3?(i.title=e.data.title,i.content=e.data.content,_.value=!0):f.error(e.message)}catch(e){console.error(e)}},L=()=>{ie.confirm(`确定删除选中的${v.value.length}条数据?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{S(v.value.join(","))})},S=async o=>{try{const e=await pe({ids:o});e.code===1e3?(f.success("删除成功"),m()):f.error(e.message)}catch(e){console.error(e)}},G=()=>{U.value.validate(async o=>{if(o)try{const e=await me(p);e.code===1e3?(f.success("新增成功"),g.value=!1,m()):f.error(e.message)}catch(e){console.error(e)}})},J=()=>{D.value.validate(async o=>{if(o)try{const e={id:k.value,title:i.title,content:i.content},c=await ce(e);c.code===1e3?(f.success("修改成功"),_.value=!1,m()):f.error(c.message)}catch(e){console.error(e)}})};return Z(()=>{m()}),(o,e)=>{const c=n("el-input"),h=n("el-col"),y=n("el-icon"),s=n("el-button"),$=n("el-row"),b=n("el-table-column"),K=n("el-popconfirm"),O=n("el-table"),Q=n("el-pagination"),x=n("el-form-item"),q=n("el-form"),I=n("el-dialog"),W=ee("loading");return R(),te("div",fe,[V("div",ge,[V("div",_e,[t($,{gutter:10,style:{padding:"10px"}},{default:l(()=>[t(h,{xs:24,sm:12,md:8,lg:8,xl:8},{default:l(()=>[e[9]||(e[9]=V("span",{class:"search-title"},"标题:",-1)),t(c,{style:{"margin-top":"10px"},size:"mini",placeholder:"请输入标题",modelValue:d.title,"onUpdate:modelValue":e[0]||(e[0]=a=>d.title=a)},null,8,["modelValue"])]),_:1}),t(h,{xs:24,sm:12,md:8,lg:8,xl:8},{default:l(()=>[t(s,{style:{"margin-top":"10px"},size:"mini",type:"primary",onClick:T},{default:l(()=>[t(y,null,{default:l(()=>[t(C(le))]),_:1}),e[10]||(e[10]=r("查询 "))]),_:1}),t(s,{style:{"margin-top":"10px"},size:"mini",onClick:E},{default:l(()=>[t(y,null,{default:l(()=>[t(C(oe))]),_:1}),e[11]||(e[11]=r("重置 "))]),_:1})]),_:1})]),_:1})]),V("div",ve,[t($,{style:{"padding-top":"10px","margin-left":"10px"}},{default:l(()=>[t(s,{type:"primary",size:"mini",plain:"",onClick:P},{default:l(()=>[t(y,null,{default:l(()=>[t(C(ne))]),_:1}),e[12]||(e[12]=r("新增 "))]),_:1}),t(s,{type:"danger",disabled:v.value.length<=0,size:"mini",plain:"",onClick:L},{default:l(()=>[t(y,null,{default:l(()=>[t(C(se))]),_:1}),e[13]||(e[13]=r("删除 "))]),_:1},8,["disabled"])]),_:1}),ae((R(),re(O,{data:F.value,onSelectionChange:A,stripe:"",style:{width:"100%"}},{default:l(()=>[t(b,{type:"selection",width:"55"}),t(b,{prop:"title",label:"标题"}),t(b,{prop:"createTime",label:"创建时间"}),t(b,{label:"操作",width:"180"},{default:l(a=>[t(s,{size:"small",type:"success",onClick:X=>H(a.row.id)},{default:l(()=>e[14]||(e[14]=[r("修改")])),_:2},1032,["onClick"]),t(K,{"confirm-button-text":"确认","cancel-button-text":"取消","icon-color":"red",title:"确认删除选中的数据？",onConfirm:X=>S(a.row.id)},{reference:l(()=>[t(s,{size:"small",type:"danger"},{default:l(()=>e[15]||(e[15]=[r("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[W,z.value]]),t(Q,{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100],"page-size":d.pageSize,"current-page":d.pageNumber,onSizeChange:M,onCurrentChange:j,total:B.value},null,8,["page-size","current-page","total"])])]),t(I,{modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=a=>g.value=a),title:"新增资讯",width:"500px"},{footer:l(()=>[t(s,{onClick:e[3]||(e[3]=a=>g.value=!1)},{default:l(()=>e[16]||(e[16]=[r("取消")])),_:1}),t(s,{type:"primary",onClick:G},{default:l(()=>e[17]||(e[17]=[r("确定")])),_:1})]),default:l(()=>[t(q,{model:p,rules:N,ref_key:"addFormRef",ref:U,"label-width":"80px"},{default:l(()=>[t(x,{label:"标题",prop:"title"},{default:l(()=>[t(c,{modelValue:p.title,"onUpdate:modelValue":e[1]||(e[1]=a=>p.title=a),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),t(x,{label:"内容",prop:"content"},{default:l(()=>[t(c,{modelValue:p.content,"onUpdate:modelValue":e[2]||(e[2]=a=>p.content=a),type:"textarea",placeholder:"请输入内容",rows:4},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(I,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=a=>_.value=a),title:"修改资讯",width:"500px"},{footer:l(()=>[t(s,{onClick:e[7]||(e[7]=a=>_.value=!1)},{default:l(()=>e[18]||(e[18]=[r("取消")])),_:1}),t(s,{type:"primary",onClick:J},{default:l(()=>e[19]||(e[19]=[r("确定")])),_:1})]),default:l(()=>[t(q,{model:i,rules:N,ref_key:"updateFormRef",ref:D,"label-width":"80px"},{default:l(()=>[t(x,{label:"标题",prop:"title"},{default:l(()=>[t(c,{modelValue:i.title,"onUpdate:modelValue":e[5]||(e[5]=a=>i.title=a),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),t(x,{label:"内容",prop:"content"},{default:l(()=>[t(c,{modelValue:i.content,"onUpdate:modelValue":e[6]||(e[6]=a=>i.content=a),type:"textarea",placeholder:"请输入内容",rows:4},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Ve=Y(ye,[["__scopeId","data-v-99719ee7"]]);export{Ve as default};
