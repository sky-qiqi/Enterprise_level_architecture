import{_ as ge,u as ve,p as _e,q as o,s as be,S as ye,v as he,r as i,x as xe,d as Ce,o as J,a as n,b as l,w as a,h as u,y as z,z as ze,A as we,B as ke,C as Ve,D as Ue,c as Se,aj as Be,L as s,H as De,ak as Re,al as Ae,am as Le,an as Ie}from"./index-Ck829hgR.js";const Ne={class:"_rotations"},Pe={class:"search-table"},Fe={class:"search"},Me={class:"table"},Te={style:{width:"100%"}},Ee=["src"],je={slot:"footer",class:"dialog-footer"},qe={style:{width:"100%"}},He=["src"],$e={slot:"footer",class:"dialog-footer"},Oe={__name:"rotations",setup(Ge){ve();const B=_e(),D=o(!0),R=o([]),w=o([]),A=o(""),v=o(!1),_=o(!1),L=o([]),I=o(0),d=be({pageNumber:1,pageSize:10,name:""}),c=async()=>{try{const t=await Be(d);t.code===1e3?(L.value=t.data.records,I.value=t.data.total,D.value=!1):s.error(t.message)}catch(t){s.error(t.message)}},K=()=>{d.pageNumber=1,c()},Q=()=>c(),W=t=>{d.pageSize=t,c()},X=t=>{d.pageNumber=t,c()},Y=t=>{R.value=t.map(e=>e.id),w.value=t.map(e=>e.id)},Z=()=>{v.value=!0},k=()=>{f.value={image:""},b.value=[],v.value=!1},ee=t=>{A.value=t,_.value=!0},V=()=>{p.value={image:""},g.value=[],_.value=!1},te=()=>{De.confirm(`确定删除选中的${w.value.length}条数据?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{N(w.value.join(","))}).catch(()=>{})},N=async t=>{try{const e=await Re({ids:t});e.code===1e3?(s.success("删除成功!"),c()):s.error(e.message)}catch(e){s.error(e.message)}},f=o({image:""}),b=o([]),P=o(""),F=o(!1),M={image:[{required:!0,message:"请上传图片",trigger:"blur"}]},le=t=>{t.code===1e3?(s({type:"success",message:"上传成功!"}),b.value.push({url:t.message}),f.value.image=t.message):s.error(t.message)},ae=(t,e)=>{f.value.image="",b.value=[]},se=t=>{P.value=t.url,F.value=!0},oe=()=>{if(!f.value.image){s.error("请上传图片");return}Ae(f.value).then(t=>{t.code===1e3?(s.success("保存成功"),k(),c()):s.error(t.message)})},p=o({image:""}),g=o([]),T=o(""),E=o(!1),ne=t=>{t.code===1e3?(s({type:"success",message:"上传成功!"}),g.value.push({url:t.message}),p.value.image=t.message):s.error(t.message)},ie=(t,e)=>{p.value.image="",g.value=[]},re=t=>{T.value=t.url,E.value=!0},ue=()=>{if(!p.value.image){s.error("请上传图片");return}Le(p.value).then(t=>{t.code==1e3?(s.success("保存成功"),V(),c()):s.error(t.message)})};ye(A,t=>{t&&Ie({id:t}).then(e=>{if(e.code==1e3){p.value=e.data;const U=B.state.configure.HOST+e.data.image;g.value.push({url:U})}else s.error(e.message)})}),he(()=>{c()});const j=()=>B.state.configure.HOST+"/common/uploadImg",q=(t,e)=>{s.warning("当前文件数量超出上传限制")},H=t=>t.size/1024/1024<2?!0:(s.error("上传图片单张大小不能超过2MB"),!1);return(t,e)=>{const U=i("el-input"),y=i("el-col"),h=i("el-icon"),r=i("el-button"),x=i("el-row"),S=i("el-table-column"),de=i("el-popconfirm"),ce=i("el-table"),me=i("el-pagination"),$=i("el-upload"),C=i("el-dialog"),O=i("el-form-item"),G=i("el-form"),pe=xe("loading");return J(),Ce("div",Ne,[n("div",Pe,[n("div",Fe,[l(x,null,{default:a(()=>[l(y,{xs:24,sm:12,md:8,lg:8,xl:8},{default:a(()=>[e[3]||(e[3]=n("span",{class:"search-title"},"名称:",-1)),l(U,{style:{"margin-top":"10px"},size:"mini",placeholder:"请输入名称",modelValue:d.name,"onUpdate:modelValue":e[0]||(e[0]=m=>d.name=m)},null,8,["modelValue"])]),_:1}),l(y,{xs:24,sm:12,md:8,lg:8,xl:8},{default:a(()=>[l(r,{style:{"margin-top":"10px"},size:"mini",type:"primary",onClick:K},{default:a(()=>[l(h,null,{default:a(()=>[l(z(ze))]),_:1}),e[4]||(e[4]=u("查询 "))]),_:1}),l(r,{style:{"margin-top":"10px"},size:"mini",onClick:Q},{default:a(()=>[l(h,null,{default:a(()=>[l(z(we))]),_:1}),e[5]||(e[5]=u("重置 "))]),_:1})]),_:1})]),_:1})]),n("div",Me,[l(x,{style:{"padding-top":"10px","margin-left":"10px"}},{default:a(()=>[l(r,{type:"primary",size:"mini",plain:"",onClick:Z},{default:a(()=>[l(h,null,{default:a(()=>[l(z(Ve))]),_:1}),e[6]||(e[6]=u("新增 "))]),_:1}),l(r,{type:"danger",disabled:R.value.length<=0,size:"mini",plain:"",onClick:te},{default:a(()=>[l(h,null,{default:a(()=>[l(z(Ue))]),_:1}),e[7]||(e[7]=u("删除 "))]),_:1},8,["disabled"])]),_:1}),ke((J(),Se(ce,{data:L.value,onSelectionChange:Y,stripe:"",style:{width:"100%"}},{default:a(()=>[l(S,{type:"selection",width:"55"}),l(S,{prop:"image",label:"图片"}),l(S,{label:"操作",width:"180"},{default:a(({row:m})=>[l(r,{size:"small",type:"success",onClick:fe=>ee(m.id)},{default:a(()=>e[8]||(e[8]=[u("修改")])),_:2},1032,["onClick"]),l(de,{style:{"margin-left":"5px"},"confirm-button-text":"确认","cancel-button-text":"取消","icon-color":"red",title:"确认删除选中的数据？",onConfirm:fe=>N(m.id)},{reference:a(()=>[l(r,{size:"small",type:"danger"},{default:a(()=>e[9]||(e[9]=[u("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[pe,D.value]]),l(me,{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100],"page-size":d.pageSize,"current-page":d.pageNumber,onSizeChange:W,onCurrentChange:X,total:I.value},null,8,["page-size","current-page","total"])])]),l(C,{title:"新增轮播图",width:"40%","destroy-on-close":!0,modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=m=>v.value=m),"before-close":k},{default:a(()=>[l(G,{model:f.value,rules:M,ref:"addRuleForm"},{default:a(()=>[l(x,{gutter:10},{default:a(()=>[l(y,{xs:24,sm:24,md:24,lg:24,xl:24},{default:a(()=>[e[11]||(e[11]=n("span",{class:"search-title"}," 图片: ",-1)),n("div",Te,[l(O,{prop:"image",style:{"margin-bottom":"0"}},{default:a(()=>[l($,{"file-list":b.value,ref:"addUpload",action:j(),accept:"image/*",multiple:!1,limit:1,"before-upload":H,"list-type":"picture-card","on-preview":se,"on-exceed":q,"on-success":le,"on-remove":ae},{default:a(()=>e[10]||(e[10]=[n("i",{class:"el-icon-plus"},null,-1)])),_:1},8,["file-list","action"]),l(C,{visible:F.value},{default:a(()=>[n("img",{width:"100%",src:P.value,alt:""},null,8,Ee)]),_:1},8,["visible"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"]),n("div",je,[l(r,{size:"mini",type:"primary",onClick:oe},{default:a(()=>e[12]||(e[12]=[u("确 定")])),_:1}),l(r,{size:"mini",onClick:k},{default:a(()=>e[13]||(e[13]=[u("取 消")])),_:1})])]),_:1},8,["modelValue"]),l(C,{title:"编辑轮播图",width:"40%","destroy-on-close":!0,modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=m=>_.value=m),"before-close":V},{default:a(()=>[l(G,{model:p.value,rules:M,ref:"updateRuleForm"},{default:a(()=>[l(x,{gutter:10},{default:a(()=>[l(y,{xs:24,sm:24,md:24,lg:24,xl:24},{default:a(()=>[e[15]||(e[15]=n("span",{class:"search-title"}," 图片: ",-1)),n("div",qe,[l(O,{prop:"image",style:{"margin-bottom":"0"}},{default:a(()=>[l($,{"file-list":g.value,ref:"updateUpload",action:j(),accept:"image/*",multiple:!1,limit:1,"before-upload":H,"list-type":"picture-card","on-preview":re,"on-exceed":q,"on-success":ne,"on-remove":ie},{default:a(()=>e[14]||(e[14]=[n("i",{class:"el-icon-plus"},null,-1)])),_:1},8,["file-list","action"]),l(C,{visible:E.value},{default:a(()=>[n("img",{width:"100%",src:T.value,alt:""},null,8,He)]),_:1},8,["visible"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"]),n("div",$e,[l(r,{size:"mini",type:"primary",onClick:ue},{default:a(()=>e[16]||(e[16]=[u("确 定")])),_:1}),l(r,{size:"mini",onClick:V},{default:a(()=>e[17]||(e[17]=[u("取 消")])),_:1})])]),_:1},8,["modelValue"])])}}},Ke=ge(Oe,[["__scopeId","data-v-453c57a8"]]);export{Ke as default};
