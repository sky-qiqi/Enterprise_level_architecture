import{_ as fe,u as ve,p as be,q as d,s as z,v as _e,r as u,x as ye,d as Ve,o as H,a as c,b as t,w as a,h as g,B as xe,c as he,O as we,G as v,P as I,L as b,Q as Ce,H as $,R as Ue}from"./index-Ck829hgR.js";const ze={class:"_line"},ke={class:"search-table"},Se={class:"search"},Be={class:"table"},je=["src"],De={class:"dialog-footer"},Fe=["src"],Oe={class:"dialog-footer"},Te={__name:"line",setup(qe){ve();const k=be(),j=d(!0),w=d([]),_=d(!1),y=d(!1),D=d(0),F=d([]),h=d([]),S=d(!1),B=d(""),f=z({name:"",pageNumber:1,pageSize:10}),n=z({name:"",temperature:"",geography:"",content:"",introduce:"",images:""}),r=z({id:"",name:"",temperature:"",geography:"",content:"",introduce:"",images:""}),V=d([]),O=z({name:[{required:!0,message:"名称不能为空",trigger:"blur"},{min:2,max:50,message:"长度在2到50个字符",trigger:"blur"}],temperature:[{required:!0,message:"温度不能为空",trigger:"blur"},{type:"number",message:"温度必须为数字",trigger:"blur"}],geography:[{required:!0,message:"地理情况不能为空",trigger:"blur"}],content:[{required:!0,message:"介绍不能为空",trigger:"blur"}],introduce:[{required:!0,message:"简介不能为空",trigger:"blur"}],images:[{required:!0,message:"请上传图片",trigger:"change"}]}),G=l=>{Object.keys(r).forEach(e=>r[e]=l[e]),l.images?V.value=l.images.split(",").map(e=>({url:e})):V.value=[],C.value={...r},y.value=!0},Q=l=>{if(l.code===1e3){b({type:"success",message:"上传成功!"});const e=k.state.configure.HOST+l.message;V.value.push({url:e}),r.images=V.value.map(s=>s.url).join(",")}else v.error({title:"错误",message:l.message})},J=(l,e)=>{V.value=e,r.images=e.map(s=>s.url).join(",")},K=async()=>{try{const l=await Ue(r);l.code===1e3?(b.success("修改成功"),y.value=!1,m()):v.error({title:"错误",message:l.message})}catch(l){v.error({title:"错误",message:l.message})}},m=async()=>{try{const l=await we(f);l.code===1e3?(F.value=l.data.records,D.value=l.data.total,j.value=!1):v.error({title:"错误",message:l.message})}catch(l){console.error(l)}},W=()=>{Object.keys(n).forEach(l=>n[l]=""),h.value=[],_.value=!0},X=async()=>{try{const l=await Ce(n);l.code===1e3?(b.success("新增成功"),_.value=!1,m()):v.error({title:"错误",message:l.message})}catch(l){v.error({title:"错误",message:l.message})}},Y=()=>{f.pageNumber=1,m()},Z=()=>{f.name="",m()},ee=l=>{f.pageSize=l,m()},le=l=>{f.pageNumber=l,m()},te=l=>{w.value=l.map(e=>e.id)},ae=()=>{_.value=!1,m()},oe=async()=>{if(w.value.length!==0)try{await I({ids:w.value.join(",")}),b.success("删除成功!"),m()}catch(l){v.error({title:"错误",message:l.message})}},se=async l=>{try{await I({ids:l}),b.success("删除成功!"),m()}catch(e){v.error({title:"错误",message:e.message})}},C=d({}),T=()=>Object.keys(updateForm).some(l=>updateForm[l]!==C.value[l]),re=l=>{T()?$.confirm("存在未保存的更改，确定要关闭吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l(),Object.assign(updateForm,C.value)}).catch(()=>{}):l()},ne=()=>{T()?$.confirm("确定放弃当前修改？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{y.value=!1,Object.assign(updateForm,C.value)}):y.value=!1},q=()=>k.state.configure.HOST+"/common/uploadImg",L=(l,e)=>{b.warning("当前文件数量超出上传限制")},M=l=>l.size/1024/1024<2?!0:(b.error("上传图片单张大小不能超过2MB"),!1),N=l=>{B.value=l.url,S.value=!0},ie=l=>{if(l.code===1e3){b({type:"success",message:"上传成功!"});const e=k.state.configure.HOST+l.message;h.value.push({url:e}),_.value?n.images=h.value.map(s=>s.url).join(","):y.value&&(r.images=h.value.map(s=>s.url).join(","))}else v.error({title:"错误",message:l.message})},ue=(l,e)=>{e.value=e};return _e(()=>{m()}),(l,e)=>{const s=u("el-input"),R=u("el-col"),p=u("el-button"),E=u("el-row"),x=u("el-table-column"),de=u("el-popconfirm"),me=u("el-table"),pe=u("el-pagination"),i=u("el-form-item"),P=u("el-upload"),U=u("el-dialog"),A=u("el-form"),ce=ye("loading");return H(),Ve("div",ze,[c("div",ke,[c("div",Se,[t(E,{gutter:10,style:{padding:"10px"}},{default:a(()=>[t(R,{xs:24,sm:12,md:8,lg:8,xl:8},{default:a(()=>[e[14]||(e[14]=c("span",{class:"search-title"},"名称:",-1)),t(s,{style:{"margin-top":"10px"},size:"mini",placeholder:"请输入名称",modelValue:f.name,"onUpdate:modelValue":e[0]||(e[0]=o=>f.name=o)},null,8,["modelValue"])]),_:1}),t(R,{xs:24,sm:12,md:8,lg:8,xl:8},{default:a(()=>[t(p,{style:{"margin-top":"10px"},size:"mini",type:"primary",onClick:Y,icon:"Search"},{default:a(()=>e[15]||(e[15]=[g("查询")])),_:1}),t(p,{style:{"margin-top":"10px"},size:"mini",onClick:Z,icon:"Refresh"},{default:a(()=>e[16]||(e[16]=[g("重置")])),_:1})]),_:1})]),_:1})]),c("div",Be,[t(E,{style:{"padding-top":"10px","margin-left":"10px"}},{default:a(()=>[t(p,{type:"primary",size:"mini",icon:"Plus",plain:"",onClick:W},{default:a(()=>e[17]||(e[17]=[g("新增")])),_:1}),t(p,{type:"danger",disabled:w.value.length<=0,size:"mini",icon:"Delete",plain:"",onClick:oe},{default:a(()=>e[18]||(e[18]=[g("删除")])),_:1},8,["disabled"])]),_:1}),xe((H(),he(me,{data:F.value,onSelectionChange:te,stripe:"",style:{width:"100%"}},{default:a(()=>[t(x,{type:"selection",width:"55"}),t(x,{prop:"name",label:"名称"}),t(x,{prop:"temperature",label:"温度"}),t(x,{prop:"geography",label:"地理情况"}),t(x,{prop:"createTime",label:"创建时间"}),t(x,{label:"操作",width:"180"},{default:a(o=>[t(p,{size:"small",type:"success",onClick:ge=>G(o.row)},{default:a(()=>e[19]||(e[19]=[g("修改")])),_:2},1032,["onClick"]),t(de,{"confirm-button-text":"确认","cancel-button-text":"取消","icon-color":"red",title:"确认删除选中的数据？",onConfirm:ge=>se(o.row.id)},{reference:a(()=>[t(p,{size:"small",type:"danger"},{default:a(()=>e[20]||(e[20]=[g("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[ce,j.value]]),t(pe,{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100],"page-size":f.pageSize,"current-page":f.pageNumber,onSizeChange:ee,onCurrentChange:le,total:D.value},null,8,["page-size","current-page","total"])])]),t(U,{modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=o=>_.value=o),title:"新增线路",width:"500px",onClose:ae},{footer:a(()=>[c("span",De,[t(p,{onClick:e[6]||(e[6]=o=>_.value=!1)},{default:a(()=>e[22]||(e[22]=[g("取消")])),_:1}),t(p,{type:"primary",onClick:X},{default:a(()=>e[23]||(e[23]=[g("确认")])),_:1})])]),default:a(()=>[t(A,{model:n,"label-width":"80px",rules:O,ref:"addFormRef"},{default:a(()=>[t(i,{label:"名称",prop:"name"},{default:a(()=>[t(s,{modelValue:n.name,"onUpdate:modelValue":e[1]||(e[1]=o=>n.name=o),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),t(i,{label:"介绍",prop:"content"},{default:a(()=>[t(s,{modelValue:n.content,"onUpdate:modelValue":e[2]||(e[2]=o=>n.content=o),type:"textarea",rows:3,placeholder:"请输入介绍"},null,8,["modelValue"])]),_:1}),t(i,{label:"简介",prop:"introduce"},{default:a(()=>[t(s,{modelValue:n.introduce,"onUpdate:modelValue":e[3]||(e[3]=o=>n.introduce=o),type:"textarea",rows:3,placeholder:"请输入简介"},null,8,["modelValue"])]),_:1}),t(i,{label:"温度",prop:"temperature"},{default:a(()=>[t(s,{modelValue:n.temperature,"onUpdate:modelValue":e[4]||(e[4]=o=>n.temperature=o),modelModifiers:{number:!0},placeholder:"请输入温度"},null,8,["modelValue"])]),_:1}),t(i,{label:"地理情况",prop:"geography"},{default:a(()=>[t(s,{modelValue:n.geography,"onUpdate:modelValue":e[5]||(e[5]=o=>n.geography=o),placeholder:"请输入地理情况"},null,8,["modelValue"])]),_:1}),t(i,{label:"图片",prop:"images"},{default:a(()=>[t(P,{"file-list":h.value,ref:"upload",action:q(),accept:"image/*",multiple:!1,limit:5,"before-upload":M,"list-type":"picture-card","on-preview":N,"on-exceed":L,"on-success":ie,"on-remove":ue},{default:a(()=>e[21]||(e[21]=[c("i",{class:"el-icon-plus"},null,-1)])),_:1},8,["file-list","action"]),t(U,{title:"预览",visible:S.value},{default:a(()=>[c("img",{width:"100%",src:B.value,alt:""},null,8,je)]),_:1},8,["visible"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),t(U,{modelValue:y.value,"onUpdate:modelValue":e[13]||(e[13]=o=>y.value=o),title:"修改线路",width:"500px","before-close":re},{footer:a(()=>[c("span",Oe,[t(p,{onClick:ne},{default:a(()=>e[25]||(e[25]=[g("取消")])),_:1}),t(p,{type:"primary",onClick:K},{default:a(()=>e[26]||(e[26]=[g("确认")])),_:1})])]),default:a(()=>[t(A,{model:r,"label-width":"80px",rules:O,ref:"updateFormRef"},{default:a(()=>[t(i,{label:"名称",prop:"name"},{default:a(()=>[t(s,{modelValue:r.name,"onUpdate:modelValue":e[8]||(e[8]=o=>r.name=o),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),t(i,{label:"介绍",prop:"content"},{default:a(()=>[t(s,{modelValue:r.content,"onUpdate:modelValue":e[9]||(e[9]=o=>r.content=o),type:"textarea",rows:3,placeholder:"请输入介绍"},null,8,["modelValue"])]),_:1}),t(i,{label:"简介",prop:"introduce"},{default:a(()=>[t(s,{modelValue:r.introduce,"onUpdate:modelValue":e[10]||(e[10]=o=>r.introduce=o),type:"textarea",rows:3,placeholder:"请输入简介"},null,8,["modelValue"])]),_:1}),t(i,{label:"温度",prop:"temperature"},{default:a(()=>[t(s,{modelValue:r.temperature,"onUpdate:modelValue":e[11]||(e[11]=o=>r.temperature=o),modelModifiers:{number:!0},placeholder:"请输入温度"},null,8,["modelValue"])]),_:1}),t(i,{label:"地理情况",prop:"geography"},{default:a(()=>[t(s,{modelValue:r.geography,"onUpdate:modelValue":e[12]||(e[12]=o=>r.geography=o),placeholder:"请输入地理情况"},null,8,["modelValue"])]),_:1}),t(i,{label:"图片",prop:"images"},{default:a(()=>[t(P,{"file-list":V.value,ref:"updateUpload",action:q(),accept:"image/*",multiple:!1,limit:5,"before-upload":M,"list-type":"picture-card","on-preview":N,"on-exceed":L,"on-success":Q,"on-remove":J},{default:a(()=>e[24]||(e[24]=[c("i",{class:"el-icon-plus"},null,-1)])),_:1},8,["file-list","action"]),t(U,{title:"预览",visible:S.value},{default:a(()=>[c("img",{width:"100%",src:B.value,alt:""},null,8,Fe)]),_:1},8,["visible"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}},Me=fe(Te,[["__scopeId","data-v-549dfb2e"]]);export{Me as default};
