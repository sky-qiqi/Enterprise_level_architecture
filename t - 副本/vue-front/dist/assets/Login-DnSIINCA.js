import{_,r as u,c as f,o as h,a as t,b as r,w as i,E as w,d as k,g as v,l as x}from"./index-CQtPEPPp.js";import{_ as I}from"./bg-2-DQ5WRs7S.js";const V={data(){return{loginAccount:"",password:""}},methods:{toRegister(){this.$router.push("/register")},toForget(){this.$router.push("/forget")},login(){if(!this.loginAccount){this.$message({message:"请输入用户名",type:"warning"});return}if(!this.password){this.$message({message:"请输入密码",type:"warning"});return}const l={loginAccount:this.loginAccount,password:this.password};x(l).then(o=>{if(o.code===1e3){this.$message({message:"登录成功",type:"success"});const a=this,c=o.data.token;window.localStorage.setItem("user_token",c),console.log("登录响应数据:",o),console.log("保存的 token:",localStorage.getItem("user_token")),console.log("当前路由:",this.$router.currentRoute.value),this.getUserInfo().then(()=>{console.log("用户信息获取成功"),setTimeout(function(){console.log("准备跳转到首页"),a.$router.push("/index").catch(s=>{console.error("路由跳转失败:",s)})},1e4)}).catch(s=>{console.error("获取用户信息失败:",s)})}else this.$message.error(o.message)}).catch(o=>{console.error("登录请求失败:",o),this.$message.error("登录失败，请重试")})},getUserInfo(){return v().then(l=>{l.code===1e3&&window.localStorage.setItem("user_info",JSON.stringify(l.data))})}}},U={class:"login"},y={class:"login4"},A={class:"login5"},C={class:"login-links"};function b(l,o,a,c,s,n){const m=u("User"),g=w,d=k,p=u("Lock");return h(),f("div",U,[t("div",y,[t("div",A,[o[5]||(o[5]=t("img",{src:I,style:{"margin-bottom":"10px"}},null,-1)),o[6]||(o[6]=t("div",{class:"login6"},"欢迎使用",-1)),r(d,{modelValue:s.loginAccount,"onUpdate:modelValue":o[0]||(o[0]=e=>s.loginAccount=e),placeholder:"请输入登录账号"},{prefix:i(()=>[r(g,null,{default:i(()=>[r(m)]),_:1})]),_:1},8,["modelValue"]),r(d,{type:"password",modelValue:s.password,"onUpdate:modelValue":o[1]||(o[1]=e=>s.password=e),placeholder:"请输入用户密码"},{prefix:i(()=>[r(g,null,{default:i(()=>[r(p)]),_:1})]),_:1},8,["modelValue"]),t("div",C,[t("div",{class:"login7",onClick:o[2]||(o[2]=(...e)=>n.toForget&&n.toForget(...e))},"忘记密码？"),t("div",{class:"login-register",onClick:o[3]||(o[3]=(...e)=>n.toRegister&&n.toRegister(...e))},"注册")]),t("div",{class:"login-submit",onClick:o[4]||(o[4]=(...e)=>n.login&&n.login(...e))},"登 录")])])])}const S=_(V,[["render",b],["__scopeId","data-v-40411ebf"]]);export{S as default};
