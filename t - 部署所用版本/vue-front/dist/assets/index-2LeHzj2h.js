import{_ as V,f as h,u as j,h as D,i as H,c as r,o as a,a as e,b as o,j as w,k as m,w as c,m as M,n as P,p as q,q as G,e as B,t as k,F as R,s as E,v as J,x as K,y as O,z as Q,A as W,B as X,C as Y,r as T,D as Z,G as tt,H as et,I as st,J as ot,K as nt,L as at,M as it}from"./index-PRjfuCQ0.js";/* empty css                         */import{_ as F}from"./ai-BsaaMcx6.js";import{_ as lt}from"./header-D64wlt_7.js";/* empty css                *//* empty css               *//* empty css                    */import"./bg-2-DQ5WRs7S.js";const rt={class:"rank-page"},ct={key:0},dt={key:1,class:"empty-tip"},ut={class:"guess-section"},_t=["src"],pt={class:"guess-title"},ht={class:"guess-desc"},mt={key:0,class:"guess-loading"},vt={key:1,class:"empty-tip"},ft={__name:"rank",setup(s){const l=h([]),_=h(!1),v=h([]),u=h(!1),f=j(),g=h("attractions"),y=h([]),x=async()=>{_.value=!0;try{const t=await W();console.log("rankRes",t);let i=Array.isArray(t.data)?t.data:[];i.forEach((p,L)=>p.rank=L+1),l.value=i}catch(t){console.error("fetchRankList error:",t),l.value=[]}finally{_.value=!1}},$=async()=>{u.value=!0;try{const t=await X();console.log("recommendList",t.data),v.value=t.data||[]}catch{v.value=[]}finally{u.value=!1}},C=t=>{f.push(`/lineInfo?id=${t.id}`)};D(()=>{x(),$(),I()});const I=async()=>{var i;const t=await H({pageNum:1,pageSize:100});t.code===1e3&&Array.isArray((i=t.data)==null?void 0:i.list)&&(y.value=t.data.list.map(p=>p.line_id))};function d(t){return t?Array.isArray(t)?t[0]:typeof t=="string"&&t.includes(",")?t.split(",")[0]:t:""}return(t,i)=>{const p=M,L=P,b=q,N=Y,A=Q,S=K,U=J,z=O;return a(),r("div",rt,[i[2]||(i[2]=e("h2",null,"排行榜",-1)),o(L,{modelValue:g.value,"onUpdate:modelValue":i[0]||(i[0]=n=>g.value=n),onTabClick:x},{default:c(()=>[o(p,{label:"景点排行榜",name:"attractions"}),o(p,{label:"路线排行榜",name:"routes"})]),_:1},8,["modelValue"]),!_.value&&l.value.length?(a(),w(N,{key:0,data:l.value,style:{width:"100%","margin-top":"20px"},onRowClick:C},{default:c(()=>[o(b,{prop:"rank",label:"排名",width:"80"}),o(b,{prop:"name",label:g.value==="attractions"?"景点名称":"路线名称"},null,8,["label"]),o(b,{prop:"favorCount",label:"收藏量",width:"120"},{default:c(n=>[e("span",{style:G({color:y.value.includes(n.row.id)?"red":""})},[B(k(n.row.favorCount)+" ",1),y.value.includes(n.row.id)?(a(),r("span",ct,"（已收藏）")):m("",!0)],4)]),_:1}),o(b,{prop:"orderCount",label:"预定量",width:"120"})]),_:1},8,["data"])):m("",!0),!_.value&&!l.value.length?(a(),r("div",dt,"暂无数据")):m("",!0),_.value?(a(),w(A,{key:2,rows:5,animated:"",style:{"margin-top":"20px"}})):m("",!0),e("div",ut,[i[1]||(i[1]=e("h3",null,"猜你喜欢",-1)),o(z,{gutter:16},{default:c(()=>[(a(!0),r(R,null,E(v.value,n=>(a(),w(U,{key:n.id,span:8},{default:c(()=>[o(S,{class:"guess-card",shadow:"hover",onClick:Bt=>C(n),style:{cursor:"pointer"}},{default:c(()=>[e("img",{src:d(n.images),style:{width:"100%",height:"100px","object-fit":"cover"}},null,8,_t),e("div",pt,k(n.name),1),e("div",ht,k(n.desc||n.description||n.intro||n.introduce||"暂无简介"),1)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),u.value?(a(),r("div",mt,[o(A,{rows:2,animated:""})])):m("",!0),!u.value&&!v.value.length?(a(),r("div",vt,"暂无推荐")):m("",!0)])])}}},gt=V(ft,[["__scopeId","data-v-720ea9a1"]]),yt={computed:{$store(){return it}},data(){return{rotations:[],attractions:[],count:0,line:[]}},components:{headers:lt,ai:F,rank:gt},methods:{toAttraction(){this.$router.push("/attractions")},toLine(){this.$router.push("/line")},toInfo(s){this.$router.push("/attractionsInfo?id="+s)},toLineInfo(s){this.$router.push("/lineInfo?id="+s)},getRotationsList(){at().then(s=>{s.code===1e3&&(this.rotations=s.data)})},getAttractionsIndex(){nt().then(s=>{s.code===1e3&&(this.attractions=s.data)})},getUserCount(){ot().then(s=>{s.code===1e3&&(this.count=s.data)})},getLineIndex(){st().then(s=>{s.code===1e3&&(this.line=s.data)})}},created(){},mounted(){this.getRotationsList(),this.getAttractionsIndex(),this.getUserCount(),this.getLineIndex()}},kt={class:"index"},xt={class:"index12"},Ct=["src"],bt={class:"index1"},wt={class:"index2"},$t={class:"index4"},It=["src"],Lt={class:"index6"},Rt={class:"index7"},Et={class:"index8"},At=["onClick"],Tt={class:"index12"};function Vt(s,l,_,v,u,f){const g=F,y=T("headers"),x=Z,$=tt,C=et,I=T("rank");return a(),r("div",kt,[o(g),o(y),e("div",xt,[o($,{height:"500px"},{default:c(()=>[(a(!0),r(R,null,E(u.rotations,(d,t)=>(a(),w(x,{key:t},{default:c(()=>[e("img",{style:{width:"100%",height:"100%","object-fit":"cover"},src:f.$store.state.HOST+d.image},null,8,Ct)]),_:2},1024))),128))]),_:1})]),e("div",bt,[e("div",wt,[l[1]||(l[1]=e("div",{class:"index3"}," 推荐景点 ",-1)),e("div",$t,[(a(!0),r(R,null,E(u.attractions,(d,t)=>(a(),r("div",{class:"index5",key:t},[e("img",{style:{width:"100%",height:"220px"},src:d.images.split(",")[0]},null,8,It),e("div",Lt,[e("div",Rt,k(d.name),1),e("div",Et,k(d.introduce),1)]),e("div",{class:"index9",style:{"margin-top":"10px"},onClick:i=>f.toInfo(d.id)}," 预 约 ",8,At)]))),128))]),o(C,{style:{"margin-top":"10px"},size:"small",type:"primary",plain:"",onClick:f.toAttraction},{default:c(()=>l[0]||(l[0]=[B("查看更多")])),_:1,__:[0]},8,["onClick"])])]),e("div",Tt,[o(I)])])}const Mt=V(yt,[["render",Vt],["__scopeId","data-v-6f5ae7d5"]]);export{Mt as default};
