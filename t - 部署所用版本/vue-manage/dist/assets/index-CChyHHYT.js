import{_ as $,m as b,r as o,c as g,o as v,w as n,a as l,b as s,n as I,d as P,e as N,f as S,g as O,t as x,h as w,K as z,l as B,i as q,j as M}from"./index-Ck829hgR.js";import{_ as E}from"./bg-2-DQ5WRs7S.js";const D={name:"Aside",data(){return{isCollapse:!1,textColor:"#A4B7CC"}},computed:{...b({activeMenuArrary:t=>t.menu.activeMenuArrary,displayMenus:t=>t.menu.displayMenus})},methods:{handleSelect(t){const e=t.split("@");this.$router.push({path:e[0]}),this.$store.commit("menu/setActiveMenu",e[0]);for(let c=0;c<this.activeMenuArrary.length;c++)if(this.activeMenuArrary[c].url===e[0])return;const u={name:e[1],url:e[0]};this.$store.commit("menu/addActiveMenu",u)}},mounted(){this.$store.commit("menu/setActiveMenu",this.$route.path);for(let e=0;e<this.activeMenuArrary.length;e++)if(this.activeMenuArrary[e].url===this.$route.path)return;const t={name:this.$route.name,url:this.$route.path};this.$store.commit("menu/addActiveMenu",t)}},K={key:0};function R(t,e,u,c,r,d){const _=o("PieChart"),a=o("el-icon"),i=o("el-menu-item"),f=o("Grid"),h=o("Promotion"),m=o("Help"),p=o("Shop"),C=o("Service"),A=o("HelpFilled"),k=o("PictureFilled"),y=o("Platform"),U=o("User"),V=o("el-submenu"),F=o("el-menu"),H=o("el-aside");return v(),g(H,{width:r.isCollapse?"64px":"240px"},{default:n(()=>[l("div",{class:"back-icon",style:I({width:r.isCollapse?"63px":"239px"})},e[0]||(e[0]=[l("img",{class:"logo",style:{"border-radius":"20px",width:"auto",height:"80px"},src:E},null,-1)]),4),s(F,{onSelect:d.handleSelect,collapse:r.isCollapse,"collapse-transition":!1,class:"el-menu-vertical","unique-opened":!0,"background-color":"#222B40","text-color":r.textColor,"default-active":this.$route.path+"@"+this.$route.name},{default:n(()=>[s(i,{index:"/index@首页"},{default:n(()=>[s(a,null,{default:n(()=>[s(_)]),_:1}),e[1]||(e[1]=l("span",null,"首页",-1))]),_:1}),s(i,{index:"/attractions@景点管理"},{default:n(()=>[s(a,null,{default:n(()=>[s(f)]),_:1}),e[2]||(e[2]=l("span",null,"景点管理",-1))]),_:1}),s(i,{index:"/order@景点预约"},{default:n(()=>[s(a,null,{default:n(()=>[s(h)]),_:1}),e[3]||(e[3]=l("span",null,"景点预约",-1))]),_:1}),s(i,{index:"/line@线路管理"},{default:n(()=>[s(a,null,{default:n(()=>[s(m)]),_:1}),e[4]||(e[4]=l("span",null,"线路管理",-1))]),_:1}),s(i,{index:"/hotel@酒店管理"},{default:n(()=>[s(a,null,{default:n(()=>[s(p)]),_:1}),e[5]||(e[5]=l("span",null,"酒店管理",-1))]),_:1}),s(i,{index:"/orderHotel@酒店预约"},{default:n(()=>[s(a,null,{default:n(()=>[s(C)]),_:1}),e[6]||(e[6]=l("span",null,"酒店预约",-1))]),_:1}),s(i,{index:"/forum@资讯管理"},{default:n(()=>[s(a,null,{default:n(()=>[s(A)]),_:1}),e[7]||(e[7]=l("span",null,"资讯管理",-1))]),_:1}),s(i,{index:"/rotations@轮播图管理"},{default:n(()=>[s(a,null,{default:n(()=>[s(k)]),_:1}),e[8]||(e[8]=l("span",null,"轮播图管理",-1))]),_:1}),s(V,{index:"1"},{title:n(()=>[s(a,null,{default:n(()=>[s(y)]),_:1}),r.isCollapse?N("",!0):(v(),P("span",K,"用户管理"))]),default:n(()=>[s(i,{index:"/admin@管理员管理"},{default:n(()=>[s(a,null,{default:n(()=>[s(y)]),_:1}),e[9]||(e[9]=l("span",null,"管理员管理",-1))]),_:1}),s(i,{index:"/user@普通用户管理"},{default:n(()=>[s(a,null,{default:n(()=>[s(U)]),_:1}),e[10]||(e[10]=l("span",null,"普通用户管理",-1))]),_:1})]),_:1})]),_:1},8,["onSelect","collapse","text-color","default-active"])]),_:1},8,["width"])}const T=$(D,[["render",R],["__scopeId","data-v-7bb4f786"]]),G={name:"main",data(){return{user:{},oldPassword:"",newPassword:"",passwordDialogVisible:!1}},methods:{handlePasswordClose(){this.$bus.$emit("password",!1)},passwordSubmit(){var t={id:this.user.id,password:this.oldPassword,newPassword:this.newPassword};O(t).then(e=>{e.code==1e3?(this.$notify.success({title:"成功",message:"密码修改成功"}),this.$bus.$emit("password",!1)):this.$notify.error({title:"错误",message:e.message})})},clearKeepAlive(t){this.$children.forEach(e=>{e.$children.forEach(u=>{u.$vnode.data.key==t&&this._myDestory(u)})})},_myDestory(t){if(t.$vnode&&t.$vnode.data.keepAlive&&t.$vnode.parent&&t.$vnode.parent.componentInstance&&t.$vnode.parent.componentInstance.cache&&t.$vnode.componentOptions){var e=t.$vnode.key==null?t.$vnode.componentOptions.Ctor.cid+(t.$vnode.componentOptions.tag?`::${t.$vnode.componentOptions.tag}`:""):t.$vnode.key,u=t.$vnode.parent.componentInstance.cache,c=t.$vnode.parent.componentInstance.keys;if(u[e]){if(c.length){var r=c.indexOf(e);r>-1&&c.splice(r,1)}delete u[e]}}t.$destroy()}},computed:{fullPath(){return this.$route.fullPath},...S("user",["getUser"])},created(){},mounted(){this.user=JSON.parse(this.getUser)}},J={slot:"footer",class:"dialog-footer"};function L(t,e,u,c,r,d){const _=o("el-input"),a=o("el-button"),i=o("el-dialog"),f=o("router-view"),h=o("el-main");return v(),g(h,{class:"el-main"},{default:n(()=>[s(i,{title:"修改密码",visible:r.passwordDialogVisible,width:"30%","before-close":d.handlePasswordClose},{default:n(()=>[l("span",null,"请输入"+x(r.user.userName)+"的旧密码：",1),s(_,{style:{"margin-top":"10px"},"show-password":"",modelValue:r.oldPassword,"onUpdate:modelValue":e[0]||(e[0]=m=>r.oldPassword=m),size:"mini",autocomplete:"off"},null,8,["modelValue"]),l("span",null,"请输入"+x(r.user.userName)+"的新密码：",1),s(_,{style:{"margin-top":"10px"},"show-password":"",modelValue:r.newPassword,"onUpdate:modelValue":e[1]||(e[1]=m=>r.newPassword=m),size:"mini",autocomplete:"off"},null,8,["modelValue"]),l("span",J,[s(a,{size:"mini",onClick:d.handlePasswordClose},{default:n(()=>e[2]||(e[2]=[w("取 消")])),_:1},8,["onClick"]),s(a,{size:"mini",type:"primary",onClick:d.passwordSubmit},{default:n(()=>e[3]||(e[3]=[w("确 定")])),_:1},8,["onClick"])])]),_:1},8,["visible","before-close"]),(v(),g(z,{max:"10"},[(v(),g(f,{key:d.fullPath}))],1024))]),_:1})}const j=$(G,[["render",L],["__scopeId","data-v-b77a8d41"]]),Q={name:"header",data(){return{user:{avatar:"",userName:""},search:"",collapse:!1,host:""}},computed:{...S("user",["getUser"])},methods:{toPage(t){t==="index"&&window.open("http://localhost:3000")},logout(){B().then(t=>{t.code===1e3?(q(),this.$store.dispatch("user/logout"),this.$router.push("/login")):this.$message.error(t.message)}).catch(t=>{console.error(t),this.$message.error("退出登录失败")})},handleClickUser(){console.log("点击了个人信息"),this.$router.push("/center")},changeCollapse(){this.collapse=!this.collapse,this.$bus.$emit("collapse",this.collapse)},full(){let t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen()},getUser(){this.$api.getUser().then(t=>{t.code===1e3?this.user.avatar=t.data.avatar:this.$message.error(t.message)}).catch(t=>{console.error(t),this.$message.error("获取用户信息失败")})}},created(){this.$store.state.configure&&this.$store.state.configure.HOST&&(this.host=this.$store.state.configure.HOST)},mounted(){this.user=JSON.parse(this.getUser)}},W={class:"header-right"},X={class:"manager-header-right",style:{"margin-top":"20px"}},Y={style:{"padding-right":"20px",display:"flex","align-items":"center"}},Z=["src"],ee={style:{"margin-left":"5px"}};function te(t,e,u,c,r,d){const _=o("arrow-down"),a=o("el-icon"),i=o("el-dropdown-item"),f=o("el-dropdown-menu"),h=o("el-dropdown"),m=o("el-header");return v(),g(m,{class:"header"},{default:n(()=>[l("div",{class:"icon-div",onClick:e[0]||(e[0]=(...p)=>d.changeCollapse&&d.changeCollapse(...p))},[l("i",{class:M(["icon",r.collapse?"el-icon-s-unfold":"el-icon-s-fold"])},null,2)]),l("div",W,[e[7]||(e[7]=l("div",{class:"search-input"},null,-1)),l("div",{class:"icon-div",onClick:e[1]||(e[1]=(...p)=>d.full&&d.full(...p))},e[3]||(e[3]=[l("i",{class:"icon el-icon-full-screen"},null,-1)])),l("div",X,[s(h,{style:{cursor:"pointer"}},{dropdown:n(()=>[s(f,null,{default:n(()=>[s(i,{onClick:d.handleClickUser},{default:n(()=>e[4]||(e[4]=[w("个人信息")])),_:1},8,["onClick"]),s(i,{onClick:d.logout},{default:n(()=>e[5]||(e[5]=[w("退出登录")])),_:1},8,["onClick"]),s(i,{onClick:e[2]||(e[2]=p=>d.toPage("index")),class:M(t.$route.path==="/index"?"menu_item":"")},{default:n(()=>e[6]||(e[6]=[w("返回前台")])),_:1},8,["class"])]),_:1})]),default:n(()=>[l("div",Y,[l("img",{style:{width:"45px",height:"45px","border-radius":"50%"},src:r.host+r.user.avatar,alt:""},null,8,Z),l("span",ee,x(r.user.userName),1),s(a,{color:"#fff"},{default:n(()=>[s(_)]),_:1})])]),_:1})])])]),_:1})}const se=$(Q,[["render",te],["__scopeId","data-v-baef9479"]]),ne={name:"index",data(){return{pass:""}},components:{Aside:T,Main:j,Header:se},computed:{...b({activeMenuArrary:t=>t.menu.activeMenuArrary,activeMenu:t=>t.menu.activeMenu})},methods:{leftScroll(){var t=document.getElementById("menu");t.scrollLeft-=100},rightScroll(){var t=document.getElementById("menu");t.scrollLeft+=100},openMenu(t){this.activeMenu!==t&&(this.$router.push({path:t}),this.$store.commit("menu/setActiveMenu",t))},closeMenu(t){var e=this.activeMenuArrary.length-1;for(let u=0;u<this.activeMenuArrary.length;u++)if(this.activeMenuArrary[u].url===t){e=u;break}this.activeMenu===t&&(this.$router.push({path:this.activeMenuArrary[e-1].url}),this.$store.commit("menu/setActiveMenu",this.activeMenuArrary[e-1].url)),this.$store.commit("menu/reduceActiveMenu",e),this.$bus.$emit("clearKeepAlive",t)}},created(){},mounted(){}},oe={class:"common-layout"};function le(t,e,u,c,r,d){const _=o("Aside"),a=o("el-aside"),i=o("Header"),f=o("el-header"),h=o("Main"),m=o("el-main"),p=o("el-container");return v(),P("div",oe,[s(p,null,{default:n(()=>[s(a,{width:"240px"},{default:n(()=>[s(_)]),_:1}),s(p,null,{default:n(()=>[s(f,null,{default:n(()=>[s(i)]),_:1}),s(m,null,{default:n(()=>[s(h)]),_:1})]),_:1})]),_:1})])}const ie=$(ne,[["render",le],["__scopeId","data-v-e786afe7"]]);export{ie as default};
