import{_ as De,p as Re,u as Fe,q as u,s as L,S as He,v as Le,r as p,x as Ne,d as N,o as v,a as d,b as t,w as l,h as c,y as A,z as Me,A as Te,B as $e,C as qe,D as Pe,c as x,e as B,F as de,T as ie,U as Ee,L as r,H as je,V as re,W as Oe,X as We,Y as Xe,Z as Ye}from"./index-Ck829hgR.js";const Ze={class:"_hotel"},Ge={class:"search-table"},Je={class:"search"},Ke={class:"table"},Qe={style:{width:"100%"}},et={style:{width:"100%"}},tt={style:{width:"100%"}},lt={style:{width:"100%"}},at={style:{width:"100%"}},ot=["src"],st={slot:"footer",class:"dialog-footer",style:{"text-align":"right"}},nt={style:{width:"100%"}},dt={style:{width:"100%"}},it={style:{width:"100%"}},rt={style:{width:"100%"}},ut={style:{width:"100%"}},mt=["src"],pt={slot:"footer",class:"dialog-footer"},ct={__name:"hotel",setup(ft){const h=Re(),ue=Fe(),M=u(!0),T=u([]),D=u([]),$=u(""),I=u(!1),U=u(!1),g=L({name:"",pageNumber:1,pageSize:5}),q=u(0),P=u([]),R=u([]),m=L({name:"",attractionsId:"",introduce:"",images:"",address:""}),k=u([]),E=u(""),j=u(!1),O={name:[{required:!0,message:"请输入名称",trigger:"blur"}],introduce:[{required:!0,message:"请输入介绍",trigger:"blur"}],images:[{required:!0,message:"请上传图片",trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],attractionsId:[{required:!0,message:"请选择景点",trigger:"blur"}]},n=L({name:"",attractionsId:"",introduce:"",images:"",address:""}),V=u([]),W=u(""),X=u(!1),Y=u(null),Z=u(null),y=async()=>{try{const a=await Ee(g);a.code===1e3?(P.value=a.data.records,q.value=a.data.total,M.value=!1):r.error(a.message)}catch{r.error("请求失败")}},me=a=>{T.value=a.map(e=>e.id),D.value=a.map(e=>e.id)},pe=()=>{g.pageNumber=1,y()},ce=()=>{g.name="",y()},fe=a=>{g.pageSize=a,y()},ge=a=>{g.pageNumber=a,y()},_e=()=>{I.value=!0,Q()},F=()=>{m.name="",m.attractionsId="",m.introduce="",m.images="",m.address="",k.value=[],I.value=!1},G=()=>h.state.configure.HOST+"/common/uploadImg",J=(a,e)=>{r.warning("当前文件数量超出上传限制")},K=a=>a.size/1024/1024<2?!0:(r.error("上传图片单张大小不能超过2MB"),!1),ve=a=>{a.code==1e3?(r({type:"success",message:"上传成功!"}),k.value.push({url:h.state.configure.HOST+a.message})):r.error(a.message)},ye=(a,e)=>{k.value=e},be=a=>{E.value=a.url,j.value=!0},xe=()=>{const a=k.value.map(e=>e.url).join(",");m.images=a,Y.value.validate(e=>{e&&We(m).then(s=>{s.code==1e3?(r.success({message:"保存成功"}),F(),y()):r.error(s.message)})})},Ve=a=>{$.value=a,U.value=!0,Q()},H=()=>{n.name="",n.attractionsId="",n.introduce="",n.images="",n.address="",V.value=[],U.value=!1},ze=a=>{a.code==1e3?(r({type:"success",message:"上传成功!"}),V.value.push({url:h.state.configure.HOST+a.message})):r.error(a.message)},Ce=(a,e)=>{V.value=e},he=a=>{W.value=a.url,X.value=!0},ke=()=>{const a=V.value.map(e=>e.url).join(",");n.images=a,Z.value.validate(e=>{e&&re(n).then(s=>{s.code==1e3?(r.success({message:"保存成功"}),H(),y()):r.error(s.message)})})},Q=()=>{Xe().then(a=>{a.code===1e3&&(R.value=a.data)})},Ie=()=>{je.confirm(`确定删除选中的${D.value.length}条数据?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ee(D.value.join(","))}).catch(()=>{})},ee=async a=>{try{const e=await Oe({ids:a});e.code===1e3?(r.success("删除成功"),y()):r.error(e.message)}catch{r.error("删除失败")}},te=async(a,e,s)=>{try{const i=await re({id:a,state:e,attractionsId:s});i.code===1e3?y():r.error(i.message)}catch{r.error("操作失败")}},Ue=a=>{const e={name:"房型管理",url:`/hotelItem?id=${a}`};h.commit("menu/addActiveMenu",e),ue.push("/hotelItem?id="+a),h.commit("menu/setActiveMenu",`/hotelItem?id=${a}`)};return He($,a=>{a&&Ye({id:a}).then(e=>{if(e.code==1e3){const s=e.data;if(n.name=s.name,n.attractionsId=s.attractionsId,n.introduce=s.introduce,n.address=s.address,n.id=s.id,s.images){const i=s.images.split(",");V.value=i.map(z=>({url:z}))}}else r.error(e.message)})}),Le(()=>{y()}),(a,e)=>{const s=p("el-input"),i=p("el-col"),z=p("el-icon"),f=p("el-button"),w=p("el-row"),C=p("el-table-column"),le=p("el-tag"),we=p("el-popconfirm"),Se=p("el-table"),Ae=p("el-pagination"),ae=p("el-option"),oe=p("el-select"),_=p("el-form-item"),se=p("el-upload"),S=p("el-dialog"),ne=p("el-form"),Be=Ne("loading");return v(),N("div",Ze,[d("div",Ge,[d("div",Je,[t(w,{gutter:10,style:{padding:"10px"}},{default:l(()=>[t(i,{xs:24,sm:12,md:8,lg:8,xl:8},{default:l(()=>[e[13]||(e[13]=d("span",{class:"search-title"},"名称:",-1)),t(s,{style:{"margin-top":"10px"},size:"mini",placeholder:"请输入名称",modelValue:g.name,"onUpdate:modelValue":e[0]||(e[0]=o=>g.name=o)},null,8,["modelValue"])]),_:1}),t(i,{xs:24,sm:12,md:8,lg:8,xl:8},{default:l(()=>[t(f,{style:{"margin-top":"10px"},size:"mini",type:"primary",onClick:pe},{default:l(()=>[t(z,null,{default:l(()=>[t(A(Me))]),_:1}),e[14]||(e[14]=c("查询 "))]),_:1}),t(f,{style:{"margin-top":"10px"},size:"mini",onClick:ce},{default:l(()=>[t(z,null,{default:l(()=>[t(A(Te))]),_:1}),e[15]||(e[15]=c("重置 "))]),_:1})]),_:1})]),_:1})]),d("div",Ke,[t(w,{style:{"padding-top":"10px","margin-left":"10px"}},{default:l(()=>[t(f,{type:"primary",size:"mini",onClick:_e,plain:""},{default:l(()=>[t(z,null,{default:l(()=>[t(A(qe))]),_:1}),e[16]||(e[16]=c("新增 "))]),_:1}),t(f,{type:"danger",disabled:T.value.length<=0,size:"mini",onClick:Ie},{default:l(()=>[t(z,null,{default:l(()=>[t(A(Pe))]),_:1}),e[17]||(e[17]=c("删除 "))]),_:1},8,["disabled"])]),_:1}),$e((v(),x(Se,{data:P.value,onSelectionChange:me,stripe:""},{default:l(()=>[t(C,{type:"selection",width:"55"}),t(C,{prop:"name",label:"名称"}),t(C,{prop:"introduce",label:"介绍"}),t(C,{prop:"state",label:"状态"},{default:l(({row:o})=>[o.state===0?(v(),x(le,{key:0},{default:l(()=>e[18]||(e[18]=[c("下架")])),_:1})):B("",!0),o.state===1?(v(),x(le,{key:1,type:"warning"},{default:l(()=>e[19]||(e[19]=[c("上架")])),_:1})):B("",!0)]),_:1}),t(C,{prop:"createTime",label:"创建时间"}),t(C,{label:"操作",width:"300"},{default:l(({row:o})=>[o.state===0?(v(),x(f,{key:0,size:"small",type:"info",onClick:b=>te(o.id,1,o.attractionsId)},{default:l(()=>e[20]||(e[20]=[c(" 上架 ")])),_:2},1032,["onClick"])):B("",!0),o.state===1?(v(),x(f,{key:1,size:"small",type:"info",onClick:b=>te(o.id,0,o.attractionsId)},{default:l(()=>e[21]||(e[21]=[c(" 下架 ")])),_:2},1032,["onClick"])):B("",!0),t(f,{size:"small",type:"primary",onClick:b=>Ue(o.id)},{default:l(()=>e[22]||(e[22]=[c("房型")])),_:2},1032,["onClick"]),t(f,{size:"small",type:"success",onClick:b=>Ve(o.id)},{default:l(()=>e[23]||(e[23]=[c("修改")])),_:2},1032,["onClick"]),t(we,{title:"确认删除选中的数据？","confirm-button-text":"确认","cancel-button-text":"取消",onConfirm:b=>ee(o.id)},{reference:l(()=>[t(f,{size:"small",type:"danger"},{default:l(()=>e[24]||(e[24]=[c("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[Be,M.value]]),t(Ae,{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100],"page-size":g.pageSize,"onUpdate:pageSize":e[1]||(e[1]=o=>g.pageSize=o),"current-page":g.pageNumber,"onUpdate:currentPage":e[2]||(e[2]=o=>g.pageNumber=o),total:q.value,onSizeChange:fe,onCurrentChange:ge},null,8,["page-size","current-page","total"])])]),t(S,{title:"新增酒店",width:"40%","destroy-on-close":!0,modelValue:I.value,"onUpdate:modelValue":e[7]||(e[7]=o=>I.value=o),"before-close":F},{default:l(()=>[t(ne,{model:m,rules:O,ref_key:"addRuleFormRef",ref:Y},{default:l(()=>[t(w,{gutter:10},{default:l(()=>[t(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[d("div",Qe,[t(_,{prop:"attractionsId",label:"景点名称"},{default:l(()=>[t(oe,{size:"mini",modelValue:m.attractionsId,"onUpdate:modelValue":e[3]||(e[3]=o=>m.attractionsId=o),placeholder:"请选择景点"},{default:l(()=>[(v(!0),N(de,null,ie(R.value,(o,b)=>(v(),x(ae,{key:b,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1}),t(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[d("div",et,[t(_,{prop:"name",label:"酒店名称"},{default:l(()=>[t(s,{modelValue:m.name,"onUpdate:modelValue":e[4]||(e[4]=o=>m.name=o),size:"mini",placeholder:"请输入名称",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),t(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[d("div",tt,[t(_,{prop:"address",label:"地址"},{default:l(()=>[t(s,{modelValue:m.address,"onUpdate:modelValue":e[5]||(e[5]=o=>m.address=o),size:"mini",placeholder:"请输入地址",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),t(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[d("div",lt,[t(_,{prop:"introduce",label:"介绍"},{default:l(()=>[t(s,{type:"textarea",modelValue:m.introduce,"onUpdate:modelValue":e[6]||(e[6]=o=>m.introduce=o),size:"mini",placeholder:"请输入介绍",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),t(i,{xs:24,sm:12,md:8,lg:8,xl:8},{default:l(()=>[d("div",at,[t(_,{prop:"images",label:"图片"},{default:l(()=>[t(se,{"file-list":k.value,ref:"addUpload",action:G(),accept:"image/*",multiple:!1,limit:5,"before-upload":K,"list-type":"picture-card","on-preview":be,"on-exceed":J,"on-success":ve,"on-remove":ye},{default:l(()=>e[25]||(e[25]=[d("i",{class:"el-icon-plus"},null,-1)])),_:1},8,["file-list","action"]),t(S,{title:"预览",visible:j.value},{default:l(()=>[d("img",{width:"100%",src:E.value,alt:""},null,8,ot)]),_:1},8,["visible"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"]),d("div",st,[t(f,{size:"mini",type:"primary",onClick:xe},{default:l(()=>e[26]||(e[26]=[c("确 定")])),_:1}),t(f,{size:"mini",onClick:F},{default:l(()=>e[27]||(e[27]=[c("取 消")])),_:1})])]),_:1},8,["modelValue"]),t(S,{title:"编辑酒店",width:"40%","destroy-on-close":!0,modelValue:U.value,"onUpdate:modelValue":e[12]||(e[12]=o=>U.value=o),"before-close":H},{default:l(()=>[t(ne,{model:n,rules:O,ref_key:"updateRuleFormRef",ref:Z},{default:l(()=>[t(w,{gutter:10},{default:l(()=>[t(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[d("div",nt,[t(_,{prop:"attractionsId",label:"景点名称"},{default:l(()=>[t(oe,{size:"mini",modelValue:n.attractionsId,"onUpdate:modelValue":e[8]||(e[8]=o=>n.attractionsId=o),placeholder:"请选择景点"},{default:l(()=>[(v(!0),N(de,null,ie(R.value,(o,b)=>(v(),x(ae,{key:b,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1}),t(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[d("div",dt,[t(_,{prop:"name",label:"酒店名称"},{default:l(()=>[t(s,{modelValue:n.name,"onUpdate:modelValue":e[9]||(e[9]=o=>n.name=o),size:"mini",placeholder:"请输入名称",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),t(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[d("div",it,[t(_,{prop:"address",label:"地址"},{default:l(()=>[t(s,{modelValue:n.address,"onUpdate:modelValue":e[10]||(e[10]=o=>n.address=o),size:"mini",placeholder:"请输入地址",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),t(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[d("div",rt,[t(_,{prop:"introduce",label:"介绍"},{default:l(()=>[t(s,{type:"textarea",modelValue:n.introduce,"onUpdate:modelValue":e[11]||(e[11]=o=>n.introduce=o),size:"mini",placeholder:"请输入介绍",autocomplete:"off"},null,8,["modelValue"])]),_:1})])]),_:1}),t(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[d("div",ut,[t(_,{prop:"images",label:"图片"},{default:l(()=>[t(se,{"file-list":V.value,ref:"updateUpload",action:G(),accept:"image/*",multiple:!1,limit:5,"before-upload":K,"list-type":"picture-card","on-preview":he,"on-exceed":J,"on-success":ze,"on-remove":Ce},{default:l(()=>e[28]||(e[28]=[d("i",{class:"el-icon-plus"},null,-1)])),_:1},8,["file-list","action"]),t(S,{title:"预览",visible:X.value},{default:l(()=>[d("img",{width:"100%",src:W.value,alt:""},null,8,mt)]),_:1},8,["visible"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"]),d("div",pt,[t(f,{size:"mini",type:"primary",onClick:ke},{default:l(()=>e[29]||(e[29]=[c("确 定")])),_:1}),t(f,{size:"mini",onClick:H},{default:l(()=>e[30]||(e[30]=[c("取 消")])),_:1})])]),_:1},8,["modelValue"])])}}},_t=De(ct,[["__scopeId","data-v-99a1e120"]]);export{_t as default};
