import{_ as ye,u as xe,p as we,q as p,s as S,v as Ce,r as d,x as ke,d as Ue,o as x,a as f,b as l,w as t,h as u,y as $,z as Ne,A as ze,B as Fe,C as Me,D as Ae,c as w,F as Be,E as Se,G as ee,H as $e,I as le,J as qe,L as c,M as De,N as Ee}from"./index-Ck829hgR.js";const je={class:"_attractions"},Ie={class:"search-table"},Re={class:"search"},Le={class:"table"},Te=["src"],Pe={class:"dialog-footer"},He=["src"],Oe={class:"dialog-footer"},Ge={__name:"attractions",setup(Je){const te=xe(),C=we(),E=p(!0),k=p([]);p("");const V=p(!1),y=p(!1),j=p(0),I=p([]),q=p(!1),D=p(""),g=p([]),b=S({name:"",pageNumber:1,pageSize:10}),r=S({name:"",price:null,introduce:"",content:"",num:0,realName:0,images:"",open:"",time:""}),n=S({id:"",name:"",price:null,introduce:"",content:"",num:0,realName:0,images:"",open:"",time:""}),R=S({name:[{required:!0,message:"请输入景点名称",trigger:"blur"},{min:2,max:50,message:"长度在2-50个字符",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"},{type:"number",min:0,max:99999,message:"价格范围0-99999",trigger:"blur"}],introduce:[{required:!0,message:"请输入简介",trigger:"blur"}],content:[{required:!0,message:"请输入介绍",trigger:"blur"}],num:[{type:"number",min:0,message:"库存不能小于0",trigger:"blur"}],realName:[{required:!0,message:"请选择实名",trigger:"blur"}],images:[{required:!0,message:"请上传图片",trigger:"blur"}],open:[{required:!0,message:"请输入预约须知",trigger:"blur"}],time:[{required:!0,message:"请输入入园时间",trigger:"blur"}]}),U=p(null),N=p(null),v=async()=>{try{const o=await Se(b);o.code===1e3?(I.value=o.data.records,j.value=o.data.total,E.value=!1):ee.error({title:"错误",message:o.message})}catch(o){console.error(o)}},ae=()=>{b.pageNumber=1,v()},oe=()=>{b.name="",v()},ne=o=>{b.pageSize=o,v()},re=o=>{b.pageNumber=o,v()},se=o=>{k.value=o.map(e=>e.id)},ue=()=>{V.value=!0},L=async(o,e)=>{try{(await le({id:o,state:e})).code===1e3&&await v()}catch(s){console.error(s)}},ie=o=>{const e={name:"景点评论",url:`/comments?id=${o}`};C.commit("menu/addActiveMenu",e),te.push(`/comments?id=${o}`),C.commit("menu/setActiveMenu",`/comments?id=${o}`)},de=async o=>{try{const e=await qe({id:o});e.code===1e3?(Object.assign(n,e.data),n.num=e.data.num,n.realName=e.data.realName,n.images=e.data.images,n.open=e.data.open,n.time=e.data.time,e.data.images.split(",").forEach(z=>{g.value.push({url:z})}),y.value=!0):c.error(e.message||"获取数据失败")}catch(e){console.error(e),c.error("获取数据失败")}},me=()=>{$e.confirm(`确定删除选中的${k.value.length}条数据?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{T(k.value.join(","))})},T=async o=>{try{(await De({ids:o})).code===1e3&&(c.success("删除成功!"),await v())}catch(e){console.error(e)}},pe=async()=>{try{await U.value.validate(),r.images=g.value.map(e=>e.url).join(",");const o=await Ee(r);o.code===1e3?(c.success("新增成功"),V.value=!1,await v()):c.error(o.message||"新增失败")}catch(o){console.error("提交失败:",o)}},fe=()=>{U.value&&(U.value.resetFields(),r.num=0,r.realName=0,r.images="",r.open="",r.time="",g.value=[])},ge=async()=>{try{await N.value.validate(),n.images=g.value.map(e=>e.url).join(",");const o=await le(n);o.code===1e3?(c.success("修改成功"),y.value=!1,await v()):c.error(o.message||"修改失败")}catch(o){console.error("提交修改失败:",o)}},ce=()=>{N.value&&(N.value.resetFields(),n.id="",n.num=0,n.realName=0,n.images="",n.open="",n.time="",g.value=[])},P=()=>C.state.configure.HOST+"/common/uploadImg",H=(o,e)=>{c.warning("当前文件数量超出上传限制")},O=o=>o.size/1024/1024<2?!0:(c.error("上传图片单张大小不能超过2MB"),!1),G=o=>{D.value=o.url,q.value=!0},J=o=>{if(o.code===1e3){c({type:"success",message:"上传成功!"});const e=C.state.configure.HOST+o.message;g.value.push({url:e}),V.value?r.images=g.value.map(s=>s.url).join(","):y.value&&(n.images=g.value.map(s=>s.url).join(","))}else ee.error({title:"错误",message:o.message})},K=(o,e)=>{e.value=e};return Ce(()=>{v()}),(o,e)=>{const s=d("el-input"),z=d("el-col"),F=d("el-icon"),m=d("el-button"),Q=d("el-row"),_=d("el-table-column"),W=d("el-tag"),be=d("el-popconfirm"),ve=d("el-table"),_e=d("el-pagination"),i=d("el-form-item"),X=d("el-input-number"),M=d("el-radio"),Y=d("el-radio-group"),Z=d("el-upload"),A=d("el-dialog"),h=d("el-form"),Ve=ke("loading");return x(),Ue(Be,null,[f("div",je,[f("div",Ie,[f("div",Re,[l(Q,{gutter:10,style:{padding:"10px"}},{default:t(()=>[l(z,{xs:24,sm:12,md:8,lg:8,xl:8},{default:t(()=>[e[21]||(e[21]=f("span",{class:"search-title"},"名称:",-1)),l(s,{style:{"margin-top":"10px"},size:"mini",placeholder:"请输入名称",modelValue:b.name,"onUpdate:modelValue":e[0]||(e[0]=a=>b.name=a)},null,8,["modelValue"])]),_:1}),l(z,{xs:24,sm:12,md:8,lg:8,xl:8},{default:t(()=>[l(m,{style:{"margin-top":"10px"},size:"mini",type:"primary",onClick:ae},{default:t(()=>[l(F,null,{default:t(()=>[l($(Ne))]),_:1}),e[22]||(e[22]=u("查询 "))]),_:1}),l(m,{style:{"margin-top":"10px"},size:"mini",onClick:oe},{default:t(()=>[l(F,null,{default:t(()=>[l($(ze))]),_:1}),e[23]||(e[23]=u("重置 "))]),_:1})]),_:1})]),_:1})]),f("div",Le,[l(Q,{style:{"padding-top":"10px","margin-left":"10px"}},{default:t(()=>[l(m,{type:"primary",size:"mini",plain:"",onClick:ue},{default:t(()=>[l(F,null,{default:t(()=>[l($(Me))]),_:1}),e[24]||(e[24]=u("新增 "))]),_:1}),l(m,{type:"danger",disabled:k.value.length<=0,size:"mini",plain:"",onClick:me},{default:t(()=>[l(F,null,{default:t(()=>[l($(Ae))]),_:1}),e[25]||(e[25]=u("删除 "))]),_:1},8,["disabled"])]),_:1}),Fe((x(),w(ve,{data:I.value,onSelectionChange:se,stripe:"",style:{width:"100%"}},{default:t(()=>[l(_,{type:"selection",width:"55"}),l(_,{prop:"name",label:"名称"}),l(_,{prop:"price",label:"价格"}),l(_,{prop:"introduce",label:"简介"}),l(_,{prop:"num",label:"库存"}),l(_,{prop:"state",label:"状态"},{default:t(({row:a})=>[a.state===0?(x(),w(W,{key:0},{default:t(()=>e[26]||(e[26]=[u("下架")])),_:1})):(x(),w(W,{key:1,type:"warning"},{default:t(()=>e[27]||(e[27]=[u("上架")])),_:1}))]),_:1}),l(_,{prop:"createTime",label:"创建时间"}),l(_,{label:"操作",width:"300"},{default:t(({row:a})=>[a.state===0?(x(),w(m,{key:0,size:"small",type:"info",onClick:B=>L(a.id,1)},{default:t(()=>e[28]||(e[28]=[u("上架")])),_:2},1032,["onClick"])):(x(),w(m,{key:1,size:"small",type:"info",onClick:B=>L(a.id,0)},{default:t(()=>e[29]||(e[29]=[u("下架")])),_:2},1032,["onClick"])),l(m,{size:"small",type:"primary",onClick:B=>ie(a.id)},{default:t(()=>e[30]||(e[30]=[u("评论")])),_:2},1032,["onClick"]),l(m,{size:"small",type:"success",onClick:B=>de(a.id)},{default:t(()=>e[31]||(e[31]=[u("修改")])),_:2},1032,["onClick"]),l(be,{title:"确认删除选中的数据？","confirm-button-text":"确认","cancel-button-text":"取消",onConfirm:B=>T(a.id)},{reference:t(()=>[l(m,{size:"small",type:"danger"},{default:t(()=>e[32]||(e[32]=[u("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[Ve,E.value]]),l(_e,{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100],"page-size":b.pageSize,"current-page":b.pageNumber,onSizeChange:ne,onCurrentChange:re,total:j.value},null,8,["page-size","current-page","total"])])])]),l(A,{modelValue:V.value,"onUpdate:modelValue":e[10]||(e[10]=a=>V.value=a),title:"新增景点",width:"600px",onClosed:fe},{footer:t(()=>[f("span",Pe,[l(m,{onClick:e[9]||(e[9]=a=>V.value=!1)},{default:t(()=>e[37]||(e[37]=[u("取消")])),_:1}),l(m,{type:"primary",onClick:pe},{default:t(()=>e[38]||(e[38]=[u("确认")])),_:1})])]),default:t(()=>[l(h,{model:r,rules:R,ref_key:"addFormRef",ref:U,"label-width":"80px"},{default:t(()=>[l(i,{label:"名称",prop:"name"},{default:t(()=>[l(s,{modelValue:r.name,"onUpdate:modelValue":e[1]||(e[1]=a=>r.name=a),placeholder:"请输入景点名称"},null,8,["modelValue"])]),_:1}),l(i,{label:"价格",prop:"price"},{default:t(()=>[l(s,{modelValue:r.price,"onUpdate:modelValue":e[2]||(e[2]=a=>r.price=a),modelModifiers:{number:!0},type:"number",placeholder:"请输入价格"},{append:t(()=>e[33]||(e[33]=[u("元")])),_:1},8,["modelValue"])]),_:1}),l(i,{label:"简介",prop:"introduce"},{default:t(()=>[l(s,{modelValue:r.introduce,"onUpdate:modelValue":e[3]||(e[3]=a=>r.introduce=a),type:"textarea",rows:3,placeholder:"请输入简介"},null,8,["modelValue"])]),_:1}),l(i,{label:"介绍",prop:"content"},{default:t(()=>[l(s,{modelValue:r.content,"onUpdate:modelValue":e[4]||(e[4]=a=>r.content=a),type:"textarea",rows:3,placeholder:"请输入介绍"},null,8,["modelValue"])]),_:1}),l(i,{label:"库存",prop:"num"},{default:t(()=>[l(X,{modelValue:r.num,"onUpdate:modelValue":e[5]||(e[5]=a=>r.num=a),modelModifiers:{number:!0},min:0,max:9999,"controls-position":"right"},null,8,["modelValue"])]),_:1}),l(i,{label:"实名",prop:"realName"},{default:t(()=>[l(Y,{modelValue:r.realName,"onUpdate:modelValue":e[6]||(e[6]=a=>r.realName=a)},{default:t(()=>[l(M,{label:0},{default:t(()=>e[34]||(e[34]=[u("关闭")])),_:1}),l(M,{label:1},{default:t(()=>e[35]||(e[35]=[u("开启")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"图片",prop:"images"},{default:t(()=>[l(Z,{"file-list":g.value,ref:"upload",action:P(),accept:"image/*",multiple:!1,limit:5,"before-upload":O,"list-type":"picture-card","on-preview":G,"on-exceed":H,"on-success":J,"on-remove":K},{default:t(()=>e[36]||(e[36]=[f("i",{class:"el-icon-plus"},null,-1)])),_:1},8,["file-list","action"]),l(A,{title:"预览",visible:q.value},{default:t(()=>[f("img",{width:"100%",src:D.value,alt:""},null,8,Te)]),_:1},8,["visible"])]),_:1}),l(i,{label:"预约须知",prop:"open"},{default:t(()=>[l(s,{modelValue:r.open,"onUpdate:modelValue":e[7]||(e[7]=a=>r.open=a),type:"textarea",rows:3,placeholder:"请输入预约须知"},null,8,["modelValue"])]),_:1}),l(i,{label:"入园时间",prop:"time"},{default:t(()=>[l(s,{modelValue:r.time,"onUpdate:modelValue":e[8]||(e[8]=a=>r.time=a),type:"textarea",rows:3,placeholder:"请输入入园时间"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),l(A,{modelValue:y.value,"onUpdate:modelValue":e[20]||(e[20]=a=>y.value=a),title:"修改景点",width:"600px",onClosed:ce},{footer:t(()=>[f("span",Oe,[l(m,{onClick:e[19]||(e[19]=a=>y.value=!1)},{default:t(()=>e[43]||(e[43]=[u("取消")])),_:1}),l(m,{type:"primary",onClick:ge},{default:t(()=>e[44]||(e[44]=[u("确认")])),_:1})])]),default:t(()=>[l(h,{model:n,rules:R,ref_key:"updateFormRef",ref:N,"label-width":"80px"},{default:t(()=>[l(i,{label:"名称",prop:"name"},{default:t(()=>[l(s,{modelValue:n.name,"onUpdate:modelValue":e[11]||(e[11]=a=>n.name=a),placeholder:"请输入景点名称"},null,8,["modelValue"])]),_:1}),l(i,{label:"价格",prop:"price"},{default:t(()=>[l(s,{modelValue:n.price,"onUpdate:modelValue":e[12]||(e[12]=a=>n.price=a),modelModifiers:{number:!0},type:"number",placeholder:"请输入价格"},{append:t(()=>e[39]||(e[39]=[u("元")])),_:1},8,["modelValue"])]),_:1}),l(i,{label:"简介",prop:"introduce"},{default:t(()=>[l(s,{modelValue:n.introduce,"onUpdate:modelValue":e[13]||(e[13]=a=>n.introduce=a),type:"textarea",rows:3,placeholder:"请输入简介"},null,8,["modelValue"])]),_:1}),l(i,{label:"介绍",prop:"content"},{default:t(()=>[l(s,{modelValue:n.content,"onUpdate:modelValue":e[14]||(e[14]=a=>n.content=a),type:"textarea",rows:3,placeholder:"请输入介绍"},null,8,["modelValue"])]),_:1}),l(i,{label:"库存",prop:"num"},{default:t(()=>[l(X,{modelValue:n.num,"onUpdate:modelValue":e[15]||(e[15]=a=>n.num=a),modelModifiers:{number:!0},min:0,max:9999,"controls-position":"right"},null,8,["modelValue"])]),_:1}),l(i,{label:"实名",prop:"realName"},{default:t(()=>[l(Y,{modelValue:n.realName,"onUpdate:modelValue":e[16]||(e[16]=a=>n.realName=a)},{default:t(()=>[l(M,{label:0},{default:t(()=>e[40]||(e[40]=[u("关闭")])),_:1}),l(M,{label:1},{default:t(()=>e[41]||(e[41]=[u("开启")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"图片",prop:"images"},{default:t(()=>[l(Z,{"file-list":g.value,ref:"upload",action:P(),accept:"image/*",multiple:!1,limit:5,"before-upload":O,"list-type":"picture-card","on-preview":G,"on-exceed":H,"on-success":J,"on-remove":K},{default:t(()=>e[42]||(e[42]=[f("i",{class:"el-icon-plus"},null,-1)])),_:1},8,["file-list","action"]),l(A,{title:"预览",visible:q.value},{default:t(()=>[f("img",{width:"100%",src:D.value,alt:""},null,8,He)]),_:1},8,["visible"])]),_:1}),l(i,{label:"预约须知",prop:"open"},{default:t(()=>[l(s,{modelValue:n.open,"onUpdate:modelValue":e[17]||(e[17]=a=>n.open=a),type:"textarea",rows:3,placeholder:"请输入预约须知"},null,8,["modelValue"])]),_:1}),l(i,{label:"入园时间",prop:"time"},{default:t(()=>[l(s,{modelValue:n.time,"onUpdate:modelValue":e[18]||(e[18]=a=>n.time=a),type:"textarea",rows:3,placeholder:"请输入入园时间"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},Qe=ye(Ge,[["__scopeId","data-v-19ed0686"]]);export{Qe as default};
